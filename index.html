<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Stickman Parkour Game</title>

<style>
    body {
        margin: 0;
        background: #222;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }

    #game {
        width: 100vw;
        height: 100vh;
        position: relative;
        background: linear-gradient(#444, #222);
        overflow: hidden;
    }

    /* Stickman (pakai canvas) */
    canvas {
        position: absolute;
        left: 0;
        top: 0;
        pointer-events: none;
    }

    /* Platform */
    .ground {
        position: absolute;
        bottom: 0;
        width: 200%;
        height: 80px;
        background: #555;
        animation: moveGround 2s linear infinite;
    }

    @keyframes moveGround {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
    }

    /* Obstacle */
    .obstacle {
        position: absolute;
        bottom: 80px;
        width: 40px;
        height: 60px;
        background: red;
        animation: moveObstacle 3s linear infinite;
    }

    @keyframes moveObstacle {
        0% { right: -60px; }
        100% { right: 120%; }
    }

    #score {
        position: absolute;
        top: 20px;
        left: 20px;
        color: white;
        font-size: 26px;
    }
</style>
</head>

<body>
<div id="game">
    <canvas id="stickmanCanvas"></canvas>
    <div class="ground"></div>
    <div id="obstacleContainer"></div>
    <div id="score">Score: 0</div>
</div>

<script>
const canvas = document.getElementById("stickmanCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player = {
    x: 120,
    y: canvas.height - 160,
    vy: 0,
    gravity: 0.6,
    jumpPower: -12,
    onGround: true,
    legAngle: 0
};

let score = 0;
let gameOver = false;

function drawStickman() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Badan
    ctx.strokeStyle = "white";
    ctx.lineWidth = 4;

    // Kepala
    ctx.beginPath();
    ctx.arc(player.x, player.y - 40, 12, 0, Math.PI * 2);
    ctx.stroke();

    // Badan
    ctx.beginPath();
    ctx.moveTo(player.x, player.y - 28);
    ctx.lineTo(player.x, player.y + 20);
    ctx.stroke();

    // Tangan
    ctx.beginPath();
    ctx.moveTo(player.x, player.y - 20);
    ctx.lineTo(player.x - 15, player.y);
    ctx.moveTo(player.x, player.y - 20);
    ctx.lineTo(player.x + 15, player.y);
    ctx.stroke();

    // Animasi kaki
    let legOffset = Math.sin(player.legAngle) * 14;

    ctx.beginPath();
    // Kaki kiri
    ctx.moveTo(player.x, player.y + 20);
    ctx.lineTo(player.x - 12, player.y + 50 + legOffset);

    // Kaki kanan
    ctx.moveTo(player.x, player.y + 20);
    ctx.lineTo(player.x + 12, player.y + 50 - legOffset);

    ctx.stroke();
}

function update() {
    if (gameOver) return;

    // Physics
    player.vy += player.gravity;
    player.y += player.vy;

    if (player.y >= canvas.height - 160) {
        player.y = canvas.height - 160;
        player.vy = 0;
        player.onGround = true;
    }

    // Kaki bergerak
    if (player.onGround) {
        player.legAngle += 0.2;
    }

    drawStickman();
    requestAnimationFrame(update);
}

document.addEventListener("keydown", () => {
    if (player.onGround) {
        player.vy = player.jumpPower;
        player.onGround = false;
    }
});

/* Spawn obstacle otomatis */
function spawnObstacle() {
    if (gameOver) return;

    let container = document.getElementById("obstacleContainer");
    let obs = document.createElement("div");
    obs.classList.add("obstacle");

    obs.style.bottom = "80px";

    container.appendChild(obs);

    let check = setInterval(() => {
        let obsRect = obs.getBoundingClientRect();
        let px = player.x;
        let py = player.y;

        if (
            obsRect.left < px + 20 &&
            obsRect.right > px - 20 &&
            obsRect.top < py + 20 &&
            obsRect.bottom > py - 40
        ) {
            alert("Game Over! Skor: " + score);
            gameOver = true;
        }
    }, 20);

    setTimeout(() => {
        obs.remove();
        clearInterval(check);
    }, 3000);

    score++;
    document.getElementById("score").innerText = "Score: " + score;

    setTimeout(spawnObstacle, 1500 + Math.random() * 1000);
}

update();
spawnObstacle();
</script>

</body>
</html>
